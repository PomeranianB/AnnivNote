<main>
<div id="groups">
  <div>
    <h3>グループ詳細</h3>

     <div>
      <% if @group.owner_id == current_user.id %>
        <%= link_to "承認待ち一覧", permits_path(@group),  class: "dropdown-item text-secondary bg-transparent" %>
      <% end %><br>
    </div>

    <table class="table table-hover table-inverse">
      <thead>
        <tr>
          <th></th>
          <th>グループ名</th>
          <th>オーナー</th>
          <th>紹介文</th>
          <th>メンバー</th>
          <th colspan="3"></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><%= image_tag @group.get_group_image, size: "50x50" %></td>
          <td><%= @group.name %></td>
          <td>
            <%= image_tag @group.owner.get_profile_image, size: "50x50"%>  
            　<%= @group.owner.name %>
          </td>
          <td><%= @group.introduction %></td>
          <td>
            <% @group.users.each do |user| %>
              <li style="list-style: none;">
                <%= image_tag user.get_profile_image, size: "50x50"%>
                　<%= user.name %>
              </li>
            <% end %>
          </td>
          <td>
            <% if @group.owner_id == current_user.id %>
              <%= link_to "編集", edit_group_path(@group.id), class: "btn btn-sm btn-success" %>
              <%= link_to "削除", group_path(@group.id), class: "btn btn-sm btn-danger", method: :delete, data: {confirm: "本当にグループを消しますか？"} %>
              <% elsif @group.group_users.exists?(user_id: current_user.id) %>
                <%= link_to 'グループ退出', group_group_users_path(@group), method: :delete, class: "btn btn-sm btn-danger", data: { confirm: "本当にグループを退出しますか？" } %>
              <% elsif @group.permits.exists?(user_id: current_user.id)  %>
                <%= link_to '申請取消', group_permits_path(@group), method: :delete, class: "btn btn-sm btn-danger" %>
              <% else %>
                <%= link_to '加入申請', group_permits_path(@group), method: :post, class: "btn my-custom-button" %>
            <% end %>
             </td>
          <td></td>
        </tr>
      </tbody>
    </table>
  </div>
  <%= link_to '戻る', groups_path, class: "my-custum-link" %>

</div>
</main>